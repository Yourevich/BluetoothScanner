# Описание архитектуры приложения и принятых решений

## Архитектура приложения
Приложение построено на основе **MVVM** (Model-View-ViewModel) с использованием **Combine** для управления асинхронными потоками данных. Основная идея заключается в разделении ответственности и упрощении тестирования кода.

1. **View**: 
   - Представления, описанные с помощью SwiftUI, отвечают за отображение данных и взаимодействие с пользователем.
   - Привязаны к `ViewModel` через `@StateObject` для автоматического обновления интерфейса.

2. **ViewModel**:
   - `MainViewModel` управляет состоянием приложения и обрабатывает данные, поступающие из сервисов.
   - Использует протоколы `BluetoothServiceProtocol` и `DatabaseServiceProtocol` для инверсии зависимости, что упрощает замену реализаций и тестирование.

3. **Model**:
   - `BluetoothDevice` представляет основную модель устройства.
   - `BluetoothDeviceEntity` используется для хранения данных в Core Data.

4. **Сервисы**:
   - `CoreBluetoothService` отвечает за взаимодействие с Bluetooth API. 
   - `DatabaseService` обеспечивает работу с Core Data. Реализация абстрагирована через протокол `DatabaseServiceProtocol`.

## Принятые решения

1. **Инверсия зависимости**:
   Все взаимодействия между слоями абстрагированы через протоколы, такие как `BluetoothServiceProtocol` и `DatabaseServiceProtocol`, что повышает тестируемость и модульность приложения.

2. **Обработка ошибок**:
   Реализован `enum BluetoothError` для управления ошибками, такими как отключенный Bluetooth, проблемы с авторизацией и другие сбои. Ошибки отображаются пользователю через `Alert`.

3. **Работа с Core Data**:
   - Используется Core Data с поддержкой миграций для хранения обнаруженных устройств.
   - Тип `UUID` используется для уникальной идентификации устройств, что повышает надежность и исключает ошибки с несовпадением типов.

4. **Асинхронность и оптимизация**:
   - Применяется `Combine` для подписки на данные и работы с асинхронными потоками.
   - Для предотвращения перегрузки интерфейса при большом количестве устройств используется `debounce`.

5. **UI и UX улучшения**:
   - Интерфейс построен на SwiftUI с адаптацией под разные размеры экрана.
   - Добавлены тактильные отклики через `UIImpactFeedbackGenerator`.

6. **Расширяемость**:
   - Архитектура приложения позволяет легко добавлять новые сервисы, заменять реализацию слоев или изменять бизнес-логику.

Эти решения обеспечивают устойчивость, тестируемость и удобство использования приложения.
